"use strict";(self.webpackChunkWebStories=self.webpackChunkWebStories||[]).push([[163],{60163:(e,t,n)=>{n.r(t),n.d(t,{default:()=>kt});var o=n(67294),r=n(55423);function i({width:e,height:t}){return e/t}function a(e,t=0){const n=10**t;return Math.round((e+Number.EPSILON)*n)/n}class s{constructor(e){this.comparator=e,this.heap=[],this.n=0}greater(e,t){return this.comparator(this.heap[e],this.heap[t])<0}swap(e,t){const n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n}swim(e){let t=e,n=Math.floor(t/2);for(;t>1&&this.greater(n,t);)this.swap(n,t),t=n,n=Math.floor(t/2)}sink(e){let t=e,n=2*t;for(;n<=this.n&&(n<this.n&&this.greater(n,n+1)&&(n+=1),this.greater(t,n));)this.swap(t,n),t=n,n=2*t}push(e){this.n+=1,this.heap[this.n]=e,this.swim(this.n)}pop(){if(0===this.n)return;this.swap(1,this.n),this.n-=1;const e=this.heap.pop();return this.sink(1),e}size(){return this.n}}function l(e,t,n,o){return(t-(e.length-1)*n-2*o*e.length)/e.reduce(((e,t)=>e+i(t)),0)}function c(e,t,n,o,r,i,a){const s=e.slice(t,n),c=l(s,o,i,a);return c>0?(c-r)**2*s.length:void 0}function d({photos:e,layoutOptions:t}){const{spacing:n,padding:o,containerWidth:r,targetRowHeight:d,rowConstraints:u}=t,p=function({photos:e,targetRowHeight:t,containerWidth:n}){return a(n/t/e.reduce(((e,t)=>Math.min(i(t),e)),Number.MAX_VALUE))+2}({photos:e,containerWidth:r,targetRowHeight:d}),h=function({photos:e,layoutOptions:t,targetRowHeight:n,limitNodeSearch:o,rowConstraints:r}){return i=>{var a,s;const{containerWidth:l,spacing:d,padding:u}=t,p=new Map;p.set(i,0);const h=null!=(a=null==r?void 0:r.minPhotos)?a:1,m=Math.min(o,null!=(s=null==r?void 0:r.maxPhotos)?s:1/0);for(let t=i+h;t<e.length+1&&!(t-i>m);t+=1){const o=c(e,i,t,l,n,d,u);if(void 0===o)break;p.set(t,o)}return p}}({photos:e,layoutOptions:t,targetRowHeight:d,limitNodeSearch:p,rowConstraints:u}),m=function(e,t,n){const o=function(e,t,n){const o=new Map,r=new Set,i=new Map;i.set(t,0);const a=new s((l=e=>e.weight,(e,t)=>l(t)-l(e)));var l;for(a.push({id:t,weight:0});a.size()>0;){const{id:t,weight:n}=a.pop();if(!r.has(t)){const s=e(t);r.add(t),s.forEach(((e,r)=>{const s=n+e,l=o.get(r),c=i.get(r);(void 0===c||c>s&&(c/s>1.005||void 0!==l&&l<t))&&(i.set(r,s),a.push({id:r,weight:s}),o.set(r,t))}))}}return i.has(n)?o:void 0}(e,t,n);return o?function(e,t){const n=[];for(let o=t;void 0!==o;o=e.get(o))n.push(o);return n.reverse()}(o,n):void 0}(h,0,e.length);if(void 0===m)return;const g=[];for(let t=1;t<m.length;t+=1){const a=e.map(((e,t)=>({photo:e,index:t}))).slice(m[t-1],m[t]),s=l(a.map((({photo:e})=>e)),r,n,o);g.push(a.map((({photo:e,index:t},n)=>({photo:e,layout:{height:s,width:s*i(e),index:t,photoIndex:n,photosCount:a.length}}))))}return g}function u(...e){return[...e].filter((e=>Boolean(e))).join(" ")}function p(e,{width:t,photosCount:n},{spacing:o,padding:r,containerWidth:i}){const s=o*(n-1)+2*r*n;return`calc((${e} - ${s}px) / ${a((i-s)/t,5)})`}function h(e,t){return"rows"!==t.layout?`calc(100% - ${2*t.padding}px)`:p("100%",e,t)}function m(e,t,n){var o,r;return p(null!=(r=null==(o=e.match(/calc\((.*)\)/))?void 0:o[1])?r:e,t,n)}function g(e,t,n){let o,r;const i=e.srcSet||e.images;return i&&i.length>0&&(o=i.concat(i.find((({width:t})=>t===e.width))?[]:[{src:e.src,width:e.width,height:e.height}]).sort(((e,t)=>e.width-t.width)).map((e=>`${e.src} ${e.width}w`)).join(", ")),n.sizes?r=(n.sizes.sizes||[]).map((({viewport:e,size:o})=>`${e} ${m(o,t,n)}`)).concat(m(n.sizes.size,t,n)).join(", "):o&&(r=`${Math.ceil(t.width/n.containerWidth*100)}vw`),{srcSet:o,sizes:r}}function y(e){var t,n;const{photo:r,layout:i,layoutOptions:a,imageProps:{style:s,className:l,...c}={},renderPhoto:d}=e,{onClick:p}=a,m={display:"block",boxSizing:"content-box",width:h(i,a),height:"auto",aspectRatio:`${r.width} / ${r.height}`,...a.padding?{padding:`${a.padding}px`}:null,...("columns"===a.layout||"masonry"===a.layout)&&i.photoIndex<i.photosCount-1?{marginBottom:`${a.spacing}px`}:null,...p?{cursor:"pointer"}:null,...s},y=p?e=>{p({event:e,photo:r,index:i.index})}:void 0,f={src:r.src,alt:null!=(t=r.alt)?t:"",title:r.title,onClick:y,style:m,className:u("react-photo-album--photo",l),loading:"lazy",decoding:"async",...g(r,i,a),...c},w=e=>{const{src:t,alt:n,srcSet:r,sizes:i,style:a,...s}=f;return o.createElement("img",{alt:n,...r?{srcSet:r,sizes:i}:null,src:t,style:(null==e?void 0:e.wrapped)?{display:"block",width:"100%",height:"100%"}:a,...s})},b=(({display:e,boxSizing:t,width:n,aspectRatio:o,padding:r,marginBottom:i,cursor:a})=>({display:e,boxSizing:t,width:n,aspectRatio:o,padding:r,marginBottom:i,cursor:a}))(m);return o.createElement(o.Fragment,null,null!=(n=null==d?void 0:d({photo:r,layout:i,layoutOptions:a,imageProps:f,renderDefaultPhoto:w,wrapperStyle:b}))?n:w())}function f({rowContainerProps:e,children:t}){return o.createElement("div",{...e},t)}function w(e){const{layoutOptions:t,rowIndex:n,rowsCount:r,renderRowContainer:i,rowContainerProps:{style:a,className:s,...l}={},children:c}=e,d={className:u("react-photo-album--row",s),style:{display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"flex-start",justifyContent:"space-between",...n<r-1?{marginBottom:`${t.spacing}px`}:null,...a},...l};return o.createElement(o.Fragment,null,(null!=i?i:f)({layoutOptions:t,rowIndex:n,rowsCount:r,rowContainerProps:d,children:c}))}function b(e){const{photos:t,layoutOptions:n,renderPhoto:r,renderRowContainer:i,componentsProps:{imageProps:a,rowContainerProps:s}}=e,l=d({photos:t,layoutOptions:n});return l?o.createElement(o.Fragment,null,l.map(((e,t)=>o.createElement(w,{key:`row-${t}`,layoutOptions:n,rowIndex:t,rowsCount:l.length,renderRowContainer:i,rowContainerProps:s},e.map((({photo:e,layout:t})=>o.createElement(y,{key:e.key||e.src,photo:e,layout:t,layoutOptions:n,renderPhoto:r,imageProps:a}))))))):null}function C({path:e,photos:t,containerWidth:n,columnsGaps:o,columnsRatios:r,spacing:a,padding:s}){const l=[],c=r.reduce(((e,t)=>e+t),0);for(let d=0;d<e.length-1;d+=1){const u=t.map(((e,t)=>({photo:e,index:t}))).slice(e[d],e[d+1]),p=r.reduce(((e,t,n)=>e+(o[d]-o[n])*t),0),h=(n-(e.length-2)*a-2*(e.length-1)*s-p)*r[d]/c;l.push(u.map((({photo:e,index:t},n)=>({photo:e,layout:{width:h,height:h/i(e),index:t,photoIndex:n,photosCount:u.length}}))))}return l}function x({photos:e,layoutOptions:t,targetColumnWidth:n}){const{columns:o,spacing:r,padding:a,containerWidth:s}=t,l=[],c=[];if(e.length<=o){const t=e.length>0?e.reduce(((e,t)=>e+i(t)),0)/e.length:1;for(let n=0;n<o;n+=1)l[n]=2*a,c[n]=n<e.length?i(e[n]):t;return{columnsGaps:l,columnsRatios:c,columnsModel:C({path:Array.from({length:o+1}).map(((t,n)=>Math.min(n,e.length))),photos:e,columnsRatios:c,columnsGaps:l,containerWidth:s,spacing:r,padding:a})}}const d=(e.reduce(((e,t)=>e+n/i(t)),0)+r*(e.length-o)+2*a*e.length)/o,u=function({photos:e,spacing:t,padding:n,targetColumnWidth:o,targetColumnHeight:r}){return a=>{const s=[],l=1.5*r;let c=o/i(e[a])+2*n;for(let d=a+1;d<e.length+1&&(s.push({neighbor:d,weight:(r-c)**2}),!(c>l||d===e.length));d+=1)c+=o/i(e[d])+t+2*n;return s}}({photos:e,targetColumnWidth:n,targetColumnHeight:d,spacing:r,padding:a}),p=(h=u,m=o,g=0,y=e.length,function(e,t,n){const o=[n];for(let r=n,i=t;i>0;i-=1)r=e.get(r)[i].node,o.push(r);return o.reverse()}(function(e,t,n,o){const r=new Map,i=new Set;i.add(n);for(let n=0;n<t;n+=1){const a=[...i.keys()];i.clear(),a.forEach((a=>{const s=n>0?r.get(a)[n].weight:0;e(a).forEach((({neighbor:e,weight:l})=>{let c=r.get(e);c||(c=[],r.set(e,c));const d=s+l,u=c[n+1];(!u||u.weight>d&&(u.weight/d>1.0001||a<u.node))&&(c[n+1]={node:a,weight:d}),n<t-1&&e!==o&&i.add(e)}))}))}return r}(h,m,g,y),m,y));var h,m,g,y;for(let t=0;t<p.length-1;t+=1){const n=e.slice(p[t],p[t+1]);l[t]=r*(n.length-1)+2*a*n.length,c[t]=1/n.reduce(((e,t)=>e+1/i(t)),0)}return{columnsGaps:l,columnsRatios:c,columnsModel:C({path:p,photos:e,columnsRatios:c,columnsGaps:l,containerWidth:s,spacing:r,padding:a})}}function E(e){const{photos:t,layoutOptions:n}=e,{columns:o,spacing:r,padding:i,containerWidth:a}=n,s=(a-r*(o-1)-2*i*o)/o,{columnsGaps:l,columnsRatios:c,columnsModel:d}=x({photos:t,layoutOptions:n,targetColumnWidth:s});return d.findIndex((e=>e.findIndex((({layout:{width:e,height:t}})=>e<0||t<0))>=0))>=0?o>1?E({photos:t,layoutOptions:{...n,columns:o-1}}):void 0:{columnsModel:d,columnsGaps:l,columnsRatios:c}}function v({photos:e,layoutOptions:t}){return E({photos:e,layoutOptions:t})}function _({columnContainerProps:e,children:t}){return o.createElement("div",{...e},t)}function P(e){const{layoutOptions:t,columnIndex:n,columnsCount:o,columnsGaps:r,columnsRatios:i}=e,{layout:s,spacing:l,padding:c}=t;if("masonry"===s||!r||!i)return`calc((100% - ${l*(o-1)}px) / ${o})`;const d=i.reduce(((e,t)=>e+t),0);return`calc((100% - ${a((o-1)*l+2*o*c+i.reduce(((e,t,o)=>e+(r[n]-r[o])*t),0),3)}px) * ${a(i[n]/d,5)} + ${2*c}px)`}function I(e){const{layoutOptions:t,renderColumnContainer:n,children:r,columnContainerProps:{style:i,className:a,...s}={},...l}=e,c={className:u("react-photo-album--column",a),style:{display:"flex",flexDirection:"column",flexWrap:"nowrap",alignItems:"flex-start",width:P(e),justifyContent:"columns"===t.layout?"space-between":"flex-start",...i},...s};return o.createElement(o.Fragment,null,(null!=n?n:_)({layoutOptions:t,columnContainerProps:c,children:r,...l}))}function k(e){const{photos:t,layoutOptions:n,renderPhoto:r,renderColumnContainer:i,componentsProps:{imageProps:a,columnContainerProps:s}}=e,l=v({photos:t,layoutOptions:n});if(!l)return null;const{columnsModel:c,columnsRatios:d,columnsGaps:u}=l;return o.createElement(o.Fragment,null,c.map(((e,t)=>o.createElement(I,{key:`column-${t}`,layoutOptions:n,columnIndex:t,columnsCount:c.length,columnsGaps:u,columnsRatios:d,renderColumnContainer:i,columnContainerProps:s},e.map((({photo:e,layout:t})=>o.createElement(y,{key:e.key||e.src,photo:e,layout:t,layoutOptions:n,renderPhoto:r,imageProps:a})))))))}function O(e){const{photos:t,layoutOptions:n}=e,{columns:o,spacing:r,padding:a,containerWidth:s}=n,l=(s-r*(o-1)-2*a*o)/o;if(l<=0)return o>1?O({...e,layoutOptions:{...n,columns:o-1}}):void 0;const c=[];for(let e=0;e<o;e+=1)c[e]=0;const d=t.reduce(((e,t,n)=>{const o=c.reduce(((e,t,n)=>t<c[e]-1?n:e),0);return c[o]=c[o]+l/i(t)+r+2*a,e[o].push({photo:t,index:n}),e}),Array.from({length:o}).map((()=>[])));return d.map((e=>e.map((({photo:t,index:n},o)=>({photo:t,layout:{width:l,height:l/i(t),index:n,photoIndex:o,photosCount:e.length}})))))}function Z(e){const{photos:t,layoutOptions:n,renderPhoto:r,renderColumnContainer:i,componentsProps:{imageProps:a,columnContainerProps:s}}=e,l=O({photos:t,layoutOptions:n});return l?o.createElement(o.Fragment,null,l.map(((e,t)=>o.createElement(I,{key:`masonry-column-${t}`,layoutOptions:n,columnsCount:l.length,columnIndex:t,renderColumnContainer:i,columnContainerProps:s},e.map((({photo:e,layout:t})=>o.createElement(y,{key:e.key||e.src,photo:e,layout:t,layoutOptions:n,renderPhoto:r,imageProps:a}))))))):null}function R({containerProps:e,children:t,containerRef:n}){return o.createElement("div",{ref:n,...e},t)}function M(e){const{layout:t,renderContainer:n,children:r,containerRef:i,containerProps:{style:a,className:s,...l}={}}=e,c={className:u("react-photo-album",`react-photo-album--${t}`,s),style:{display:"flex",flexWrap:"nowrap",justifyContent:"space-between",flexDirection:"rows"===t?"column":"row",...a},...l};return o.createElement(o.Fragment,null,(null!=n?n:R)({containerProps:c,containerRef:i,layout:t,children:r}))}function D(e,{newContainerWidth:t,newScrollbarWidth:n}){const{containerWidth:o,scrollbarWidth:r}=e;return void 0!==o&&void 0!==r&&void 0!==t&&void 0!==n&&t>o&&t-o<=20&&n<r?{containerWidth:o,scrollbarWidth:n}:o!==t||r!==n?{containerWidth:t,scrollbarWidth:n}:e}function W(e,t){let n=null==e?void 0:e.clientWidth;if(void 0!==n&&t&&t.length>0){const e=[...t.filter((e=>e>0))].sort(((e,t)=>t-e));e.push(Math.floor(e[e.length-1]/2));const o=n;n=e.find(((t,n)=>t<=o||n===e.length-1))}return n}const z=Object.freeze([1200,600,300,0]);function N(e,t){return"function"==typeof e?e(t):e}function S(e,t){return void 0!==e?N(e,t):void 0}function $(e,t,n,o=0){const r=S(e,t);return Math.round(Math.max(void 0===r?function(e,t){const n=z.findIndex((e=>e<=t));return N(e[n>=0?n:0],t)}(n,t):r,o))}function j(e){const{photos:t,layout:n,renderContainer:r,defaultContainerWidth:i,breakpoints:a}=e,{containerRef:s,containerWidth:l}=function(e,t){const[{containerWidth:n},r]=o.useReducer(D,{containerWidth:t}),i=o.useRef(null),a=o.useRef();return{containerRef:o.useCallback((t=>{var n;null==(n=a.current)||n.disconnect(),a.current=void 0,i.current=t;const o=()=>r({newContainerWidth:W(i.current,e),newScrollbarWidth:window.innerWidth-document.documentElement.clientWidth});o(),t&&"undefined"!=typeof ResizeObserver&&(a.current=new ResizeObserver(o),a.current.observe(t))}),[e]),containerWidth:n}}(function(e){const t=o.useRef(e);return e&&t.current&&e.join()===t.current.join()||(t.current=e),t.current}(a),i);if(!n||!["rows","columns","masonry"].includes(n)||!Array.isArray(t))return null;const c=l?function({layout:e,onClick:t,containerWidth:n,targetRowHeight:o,rowConstraints:r,columns:i,spacing:a,padding:s,sizes:l}){return{layout:e,onClick:t,containerWidth:n,columns:$(i,n,[5,4,3,2],1),spacing:$(a,n,[20,15,10,5]),padding:$(s,n,[0,0,0,0,0]),targetRowHeight:$(o,n,[e=>e/5,e=>e/4,e=>e/3,e=>e/2]),rowConstraints:S(r,n),sizes:l}}({containerWidth:l,...e}):void 0,d=function(e,t,n){const{photos:o,componentsProps:r}=e,i=N(r,t)||{};if(n){const{layout:e,spacing:t,padding:r,rowConstraints:a}=n;if("rows"===e){const{singleRowMaxHeight:e}=a||{};if(e){const n=Math.floor(o.reduce(((t,{width:n,height:o})=>t+n/o*e-2*r),r*o.length*2+t*(o.length-1)));n>0&&(i.containerProps=i.containerProps||{},i.containerProps.style={maxWidth:n,...i.containerProps.style})}}}return i}(e,l,c);return o.createElement(M,{layout:n,containerRef:s,renderContainer:r,containerProps:d.containerProps},c&&function(e,t,n){const{photos:r,layout:i,renderPhoto:a,renderRowContainer:s,renderColumnContainer:l}=e,c={photos:r,renderPhoto:a,componentsProps:t};return"rows"===i?o.createElement(b,{layoutOptions:n,renderRowContainer:s,...c}):"columns"===i?o.createElement(k,{layoutOptions:n,renderColumnContainer:l,...c}):o.createElement(Z,{layoutOptions:n,renderColumnContainer:l,...c})}(e,d,c))}var T=n(51517),B=n(12788),F=n(45896),A=n(58167),G=n(37723),H=n(46638);function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},L.apply(this,arguments)}const U="loading-indicator",V=B.ZP.span.withConfig({displayName:"loadingBar__AriaOnlyAlert",componentId:"sc-11l744v-0"})(["",""],H.j),J=(0,B.F4)(["0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}"]),q=B.ZP.div.withConfig({displayName:"loadingBar__UploadingIndicator",componentId:"sc-11l744v-1"})(["height:4px;background:",";background-size:400% 400%;position:absolute;bottom:0px;border-radius:",";animation:"," 4s ease infinite;&.","{&.appear{width:0;}&.appear-done{width:100%;transition:1s ease-out;transition-property:width;}}"],(e=>{let{theme:t}=e;return t.colors.gradient.loading}),(e=>{let{theme:t}=e;return`0px 0px ${t.borders.radius.small} ${t.borders.radius.small}`}),J,U);function Y(e){let{loadingMessage:t,...n}=e;const i=(0,r.sO)(null);return o.createElement(o.Fragment,null,t&&o.createElement(V,{role:"status"},t),o.createElement(G.Z,{nodeRef:i,in:!0,appear:!0,timeout:0,className:U},o.createElement(q,L({ref:i},n))))}var X=n(46251),K=n(41785),Q=n(4597),ee=n(64923),te=n(52195),ne=n(38421),oe=n(57820),re=(n(55537),n(84296),n(17166),n(21314),n(89703),n(1036),n(28377),n(40823),n(60293),n(89157),n(29184),n(94254),n(73393),n(76826),n(95640)),ie=(n(21377),n(29093),n(8494),n(6707),n(54850),n(80612),n(19941),n(71470),n(57549),n(44459),n(60702),n(9173),n(54234),n(7481),n(47186),n(84476),n(81550),n(62109),n(6986),n(81278),n(2775),n(35443),n(55240),n(90694),n(56169),n(1473),n(66175),n(85742),n(63589),n(38441),n(52845),n(20378),n(76129),n(88607),n(28436),n(22536),n(37890),n(89405),n(487),n(20775),n(18929),n(21694),n(9219),n(12221),n(41657),n(249),n(32696),n(88476)),ae=(n(16243),n(77850),n(12908),n(25869),n(65290),n(35698),n(80951),n(73071),n(7377),n(24355),n(68020),n(75519),n(83859),n(59048)),se=n(9518),le=n(27227),ce=n(58286),de=n(70504),ue=n(47390),pe=n(84401),he=n(74091);function me(e){let{mediaId:t,type:n,onClose:i}=e;const{actions:{deleteMedia:a}}=(0,ue.Z)(),{showSnackbar:s}=(0,le.D)(),{deleteMediaElement:l}=(0,ie.Z)((e=>{let{actions:{deleteMediaElement:t}}=e;return{deleteMediaElement:t}})),{deleteElementsByResourceId:c}=(0,pe.r)((e=>({deleteElementsByResourceId:e.actions.deleteElementsByResourceId}))),d=(0,r.I4)((async()=>{i();try{await a(t),l({id:t}),c({id:t})}catch(e){(0,re.tz)("local_media_deletion",e.message),s({message:(0,A.__)("Failed to delete media item.","web-stories"),dismissible:!0})}}),[a,l,c,t,i,s]),u=(0,A.__)("Delete Image?","web-stories"),p=(0,A.__)("Delete Video?","web-stories"),h=(0,A.__)("You are about to permanently delete this image from your site. The image will appear broken in any content that uses it.","web-stories"),m=(0,A.__)("You are about to permanently delete this video from your site. The video will appear broken in any content that uses it.","web-stories");return o.createElement(he.Z,{isOpen:!0,onClose:i,title:"image"===n?u:p,secondaryText:(0,A.__)("Cancel","web-stories"),onPrimary:d,primaryText:(0,A.__)("Delete","web-stories"),maxWidth:512},o.createElement(ce.x.Paragraph,{size:de.y.Small},"image"===n?h:m),o.createElement(ce.x.Paragraph,{size:de.y.Small,isBold:!0},(0,A.__)("This action can not be undone.","web-stories")))}var ge=n(36453),ye=n(65197),fe=n(55125),we=n(65728);const be=(0,B.iv)(["display:flex;width:","px;margin-right:28px;"],152),Ce=B.ZP.img.withConfig({displayName:"mediaEditDialog__Image",componentId:"sc-ctku7j-0"})(["",""],be),xe=B.ZP.video.withConfig({displayName:"mediaEditDialog__Video",componentId:"sc-ctku7j-1"})(["",""],be),Ee=B.ZP.div.withConfig({displayName:"mediaEditDialog__DialogBody",componentId:"sc-ctku7j-2"})(["display:flex;justify-content:left;align-items:flex-start;"]),ve=B.ZP.div.withConfig({displayName:"mediaEditDialog__MetadataTextContainer",componentId:"sc-ctku7j-3"})(["display:flex;flex-direction:column;margin:0 4px;"]),_e=(0,B.ZP)(ce.x.Span).withConfig({displayName:"mediaEditDialog__DateText",componentId:"sc-ctku7j-4"})(["margin-bottom:8px;"]),Pe=(0,B.ZP)(we.Z).withConfig({displayName:"mediaEditDialog__AssistiveTextArea",componentId:"sc-ctku7j-5"})(["margin:20px 0 4px;"]),Ie=(0,A.__)("Edit Image","web-stories"),ke=(0,A.__)("Edit Video","web-stories"),Oe=(0,A.__)("Assistive text","web-stories"),Ze=(0,A.__)("Video description","web-stories"),Re=(0,A.__)("Describe the appearance and function of the image. Leave empty if the image is purely decorative.","web-stories"),Me=(0,A.__)("For indexability and accessibility. Include any burned-in text inside the video.","web-stories");function De(e){let{resource:t,onClose:n}=e;const{id:i,src:a,creationDate:s,width:l,height:c,type:d,alt:u,poster:p,mimeType:h}=t,{actions:{updateMedia:m}}=(0,ue.Z)(),{updateMediaElement:g}=(0,ie.Z)((e=>{let{actions:{updateMediaElement:t}}=e;return{updateMediaElement:t}})),{showSnackbar:y}=(0,le.D)(),[f,w]=(0,r.eJ)(u),b=(0,ge.ZU)(s),C=(0,r.I4)((e=>{w(e.target.value)}),[]),x=(0,r.I4)((async()=>{try{await m(i,{altText:f}),g({id:i,data:{alt:f}}),n()}catch(e){(0,re.tz)("local_media_edit",e.message),y({message:(0,A.__)("Failed to update, please try again.","web-stories"),dismissible:!0})}}),[f,i,n,y,m,g]),E="image"===d;return o.createElement(he.Z,{isOpen:!0,onClose:n,title:E?Ie:ke,secondaryText:(0,A.__)("Cancel","web-stories"),onPrimary:x,primaryText:(0,A.__)("Save","web-stories")},o.createElement(Ee,null,"image"===d?o.createElement(Ce,{src:(0,fe.Z)(152,t),alt:u,loading:"lazy",crossOrigin:"anonymous",decoding:"async"}):o.createElement(xe,{key:a,crossOrigin:"anonymous",poster:p,preload:"metadata",muted:!0},o.createElement("source",{src:a,type:h})),o.createElement(ve,null,(0,ge.JY)(b)&&o.createElement(_e,{size:de.y.XSmall},(0,ye.Z)((0,A.__)("Uploaded: %s","web-stories"),(0,ge.p6)(s))),o.createElement(ce.x.Span,{size:de.y.Small},(0,ye.Z)((0,A.__)("%1$d x %2$d pixels","web-stories"),l,c)),o.createElement(Pe,{value:f,"aria-label":E?Oe:Ze,type:"text",placeholder:E?Oe:Ze,onChange:C}),o.createElement(ce.x.Paragraph,{size:de.y.Small},E?Re:Me))))}const We=(0,B.ZP)(ae.Kk).withConfig({displayName:"dropDownMenu__MoreButton",componentId:"sc-1eq0xdj-0"})(["top:4px;right:4px;"]),ze=B.ZP.div.withConfig({displayName:"dropDownMenu__DropDownContainer",componentId:"sc-1eq0xdj-1"})(["margin-top:10px;"]),Ne=B.ZP.div.withConfig({displayName:"dropDownMenu__MenuContainer",componentId:"sc-1eq0xdj-2"})(["z-index:1;"]),Se=(0,B.iv)(["min-width:160px;margin-top:0;li{display:block;}"]),$e="edit",je="delete";function Te(e){let{resource:t,display:n,isMenuOpen:i,onMenuOpen:a,onMenuCancelled:s,onMenuSelected:l,setParentActive:c=Q.Z}=e;const d=[{options:[{label:(0,A.__)("Edit meta data","web-stories"),value:$e},{label:(0,A.__)("Delete from library","web-stories"),value:je}]}],[u,p]=(0,r.eJ)(!1),[h,m]=(0,r.eJ)(!1),g=(0,r.sO)(),y=(0,r.I4)((()=>{s(),g.current?.focus(),c()}),[s,c]),{canTranscodeResource:f}=(0,ie.Z)((e=>{let{state:{canTranscodeResource:t}}=e;return{canTranscodeResource:t}})),w=(0,r.I4)((()=>{p(!1),y()}),[p,y]),b=(0,r.I4)((()=>{m(!1),y()}),[m,y]),C=(0,r.Ye)((()=>`list-${(0,K.Z)()}`),[]),x=(0,r.Ye)((()=>`button-${(0,K.Z)()}`),[]);return f(t)&&o.createElement(Ne,null,g.current&&o.createElement(se.Z,{target:g.current}),o.createElement(We,{ref:g,onClick:a,"aria-label":(0,A.__)("More","web-stories"),"aria-pressed":i,"aria-haspopup":!0,"aria-expanded":i,"aria-owns":i?C:null,id:x,$display:n,tabIndex:n||i?0:-1},o.createElement(ee.Z,null)),(n||i)&&o.createElement(te.Z,{anchor:g,placement:ne.ug.BottomStart,isOpen:i},o.createElement(ze,null,o.createElement(oe.Z,{parentId:x,listId:C,handleMenuItemSelect:(e,t)=>{switch(l(),t){case $e:m(!0);break;case je:p(!0)}},groups:d,onDismissMenu:y,hasMenuRole:!0,menuStylesOverride:Se}))),u&&o.createElement(me,{mediaId:t.id,type:t.type,onClose:w}),h&&o.createElement(De,{resource:t,onClose:b}))}var Be=n(16181),Fe=n(31271),Ae=n(98047);const Ge=(0,B.ZP)(ce.x.Span).withConfig({displayName:"attribution__StyledText",componentId:"sc-dg18hp-0"})(["color:",";"],(e=>{let{theme:t,active:n}=e;return(0,F.m4)(t.colors.standard.white,n?1:.6)})),He=B.ZP.a.withConfig({displayName:"attribution__Link",componentId:"sc-dg18hp-1"})(["display:block;position:absolute;left:0;bottom:0;width:100%;padding:8px;background-color:",";text-overflow:ellipsis;overflow:hidden;white-space:nowrap;text-decoration:none;"],(e=>{let{theme:t,active:n}=e;return(0,F.m4)(t.colors.bg.primary,n?.8:.6)})),Le=e=>{let{author:t,url:n}=e;const[i,a]=(0,r.eJ)(!1),s=()=>a(!0),l=()=>a(!1);return o.createElement(He,{title:t,active:i,onPointerEnter:s,onFocus:s,onPointerLeave:l,onBlur:l,href:n,target:"_blank",rel:"noreferrer"},o.createElement(Ge,{size:de.y.XSmall},t))};var Ue=n(16819),Ve=n(22049),Je=n(4038),qe=n(80536),Ye=n(95785);function Xe(){return Xe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Xe.apply(this,arguments)}const Ke=(0,B.iv)(["width:100%;cursor:pointer;transition:0.2s transform,0.15s opacity;border-radius:4px;opacity:0;object-fit:cover;"]),Qe=B.ZP.img.withConfig({displayName:"innerElement__Image",componentId:"sc-qkk7ov-0"})(["",""],Ke),et=B.ZP.video.withConfig({displayName:"innerElement__Video",componentId:"sc-qkk7ov-1"})([""," ",""],Ke,(e=>{let{showWithoutDelay:t}=e;return t?"opacity: 1;":""})),tt=B.ZP.div.withConfig({displayName:"innerElement__DurationWrapper",componentId:"sc-qkk7ov-2"})(["position:absolute;bottom:8px;left:8px;background:",";border-radius:100px;height:18px;padding:0 6px;"],(e=>{let{theme:t}=e;return t.colors.opacity.black64})),nt=B.ZP.div.withConfig({displayName:"innerElement__MuteWrapper",componentId:"sc-qkk7ov-3"})(["position:absolute;bottom:8px;right:8px;height:24px;width:24px;background:",";color:",";border-radius:100px;"],(e=>{let{theme:t}=e;return t.colors.opacity.black64}),(e=>{let{theme:t}=e;return t.colors.fg.primary})),ot=(0,B.ZP)(ce.x.Span).attrs({size:de.y.XSmall}).withConfig({displayName:"innerElement__Duration",componentId:"sc-qkk7ov-4"})(["color:",";display:block;"],(e=>{let{theme:t}=e;return t.colors.fg.primary})),rt=B.ZP.img.withConfig({displayName:"innerElement__CloneImg",componentId:"sc-qkk7ov-5"})(["opacity:0;width:",";height:",";position:absolute;"],(e=>{let{width:t}=e;return`${t}px`}),(e=>{let{height:t}=e;return`${t}px`}));var it=(0,r.X$)((function(e){let{type:t,src:n,resource:i,alt:a,width:s,height:l,onClick:c,onLoad:d=Q.Z,showVideoDetail:u,mediaElement:p,active:h,isMuted:m}=e;const g=(0,r.sO)(null),y=(0,r.sO)(null),{handleDrag:f,handleDrop:w}=(0,qe.Z)((e=>{let{state:t,actions:n}=e;return{handleDrag:n.handleDrag,handleDrop:n.handleDrop,dropTargets:t.dropTargets,activeDropTargetId:t.activeDropTargetId}}),((e,t)=>{if(y.current)return!1;if(null===y.current)return y.current=!1,!1;if(e?.dropTargets&&t?.dropTargets){const n=Object.keys(e.dropTargets),o=Object.keys(t.dropTargets);if(n.join()!==o.join())return!1}return e?.activeDropTargetId===t?.activeDropTargetId})),{setDraggingResource:b}=(0,qe.Z)((e=>{let{actions:{setDraggingResource:t}}=e;return{setDraggingResource:t}}));let C;(0,r.d4)((()=>{i.poster&&(g.current=i.poster)}),[i.poster]);const{lengthFormatted:x,poster:E,mimeType:v}=i,_=E??g.current,P=_||(0,fe.Z)(s,i),I={width:s,height:l,alt:a,crossOrigin:"anonymous"},k={...I,onLoad:()=>{p.current&&(p.current.style.opacity=1),d()},loading:"lazy",decoding:"async",draggable:!1},O={...k,onLoad:void 0},Z={...k,src:P},R={...I,title:a,alt:null,loop:t===Be.zc.Gif,muted:!0,preload:"metadata",poster:_,showWithoutDelay:h};if(t===Be.zc.Image||t===Be.zc.Sticker?(C=o.createElement(Qe,Xe({key:n},Z,{ref:p})),O.src=P):[Be.zc.Video,Be.zc.Gif].includes(t)&&(C=o.createElement(o.Fragment,null,E&&!h?o.createElement(Qe,Xe({key:n},Z,{ref:p})):o.createElement(et,Xe({key:n},R,{ref:p}),t===Be.zc.Gif?i.output.src&&o.createElement("source",{src:i.output.src,type:i.output.mimeType}):o.createElement("source",{src:(0,fe.Z)(s,i),type:v})),t===Be.zc.Video&&u&&x&&o.createElement(tt,null,o.createElement(ot,null,x)),t===Be.zc.Video&&u&&m&&o.createElement(nt,null,o.createElement(Ve.Z,null))),O.src=E),!C)throw new Error("Invalid media element type.");const M=t===Be.zc.Image?P:E;return o.createElement(o.Fragment,null,C,h&&o.createElement(Ye.Z,{showIcon:!1}),o.createElement(Je.Z,{active:h,handleDrag:e=>{y.current||(Ue.Z.set(i.id,{url:P,type:"cached"}),b(i),y.current=!0),f(i,e.clientX,e.clientY)},handleDragEnd:()=>{w(i),y.current=!1},type:i.type,elementProps:{resource:i},onClick:c(M),cloneElement:rt,cloneProps:O}))})),at=n(8403),st=n(25377),lt=n(26016),ct=n(10521),dt=n(7448);const ut=B.ZP.div.withConfig({displayName:"insertionMenu__DropDownContainer",componentId:"sc-xjd4tf-0"})(["margin-top:10px;min-width:160px;"]),pt=B.ZP.div.withConfig({displayName:"insertionMenu__MenuContainer",componentId:"sc-xjd4tf-1"})(["z-index:1;"]),ht=(0,B.iv)(["min-width:160px;margin-top:0;li{display:block;}"]),mt="insert",gt="addBackground";function yt(e){let{resource:t,display:n,onInsert:i,width:a,index:s,isLocal:l=!1,setParentActive:c=Q.Z,setParentInactive:d=Q.Z}=e;const u=(0,r.sO)(),[p,h]=(0,r.eJ)(!1),m=(0,r.I4)((e=>{e.stopPropagation(),h(!0)}),[]),g=(0,r.I4)((()=>{h(!1),u.current?.focus(),c()}),[c]),{currentBackgroundId:y,combineElements:f}=(0,pe.r)((e=>({currentBackgroundId:e.state.currentPage?.elements?.[0]?.id,combineElements:e.actions.combineElements}))),{type:w,poster:b}=t,C=[{options:[{label:["image","gif"].includes(w)?(0,A.__)("Insert image","web-stories"):(0,A.__)("Insert video","web-stories"),value:mt},{label:(0,A.__)("Add as background","web-stories"),value:gt}]}];(0,ct.Z)({ref:u},[],3);const x=(0,dt.Z)();(0,at.Ew)(l?null:u,"tab",x,[x]);const E=(0,r.Ye)((()=>`list-${(0,K.Z)()}`),[]),v=(0,r.Ye)((()=>`button-${(0,K.Z)()}`),[]);return o.createElement(pt,null,o.createElement(ae.Kk,{ref:u,onClick:m,"aria-label":(0,A.__)("Open insertion menu","web-stories"),"aria-pressed":p,"aria-haspopup":!0,"aria-expanded":p,"aria-owns":p?E:null,id:v,$display:n,tabIndex:0===s?0:-1},o.createElement(st.Z,null)),p&&o.createElement(te.Z,{anchor:u,placement:ne.ug.BottomStart,isOpen:p},o.createElement(ut,null,o.createElement(oe.Z,{parentId:v,listId:E,handleMenuItemSelect:(e,n)=>{const o=b||(0,fe.Z)(a,t),r=(0,lt.Z)(t.type,{resource:t});switch(h(!1),n){case mt:i(t,o);break;case gt:f({firstElement:r,secondId:y})}d()},groups:C,onDismissMenu:g,hasMenuRole:!0,menuStylesOverride:ht}))))}function ft(){return ft=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ft.apply(this,arguments)}const wt=B.ZP.div.attrs((e=>({style:{width:e.width+"px",height:e.height+"px",margin:e.margin,backgroundColor:"transparent",color:"inherit",border:"none",padding:0}}))).withConfig({displayName:"mediaElement__Container",componentId:"sc-n7038j-0"})([""]),bt=B.ZP.div.withConfig({displayName:"mediaElement__InnerContainer",componentId:"sc-n7038j-1"})(["position:relative;display:flex;margin-bottom:10px;background-color:",";"],(e=>{let{theme:t,$baseColor:n}=e;return n||(0,F.m4)(t.colors.standard.black,.3)})),Ct=(0,B.ZP)(X.E).withConfig({displayName:"mediaElement__BlurhashContainer",componentId:"sc-n7038j-2"})(["position:absolute !important;top:0;left:0;"]);function xt(e){let{index:t,resource:n,width:i,height:a,margin:s,onInsert:l,providerType:c,canEditMedia:d}=e;const{id:u,src:p,type:h,width:m,height:g,alt:y,isMuted:f,baseColor:w,blurHash:b}=n,{isCurrentResourceProcessing:C,isCurrentResourceUploading:x}=(0,ie.Z)((e=>{let{state:t}=e;return{isCurrentResourceProcessing:t.isCurrentResourceProcessing,isCurrentResourceUploading:t.isCurrentResourceUploading}})),E=m&&g?m/g:1,v=i||a/E,_=a||v/E,P=(0,r.sO)(),[I,k]=(0,r.eJ)(!0),[O,Z]=(0,r.eJ)(!1),[R,M]=(0,r.eJ)(!1),[D,W]=(0,r.eJ)(!1),z=(0,r.I4)((()=>Z(!0)),[]),N=(0,r.I4)((()=>Z(!1)),[]),S=(0,r.I4)((()=>M(!0)),[]),$=(0,r.I4)((()=>M(!1)),[]),j=(0,r.I4)((()=>{M(!1),Z(!1)}),[]),[T,B]=(0,r.eJ)(null),F=(0,r.sO)(O);F.current=O,(0,r.d4)((()=>{if(![Be.zc.Video,Be.zc.Gif].includes(h))return;const e=()=>{null!==T&&(clearTimeout(T),B(null))};if(!R)if(O){if(k(!1),P.current&&null===T){const e=setTimeout((()=>{F.current&&p&&P.current.play().catch(Ae.Z)}),600);B(e)}}else k(!0),e(),P.current&&P.current?.pause&&p&&(P.current.pause(),P.current.currentTime=0);return e}),[R,O,h,p,T,B,F]);const G=(0,r.I4)((e=>()=>{l(n,e)}),[l,n]),H=O&&n.attribution?.author?.displayName&&n.attribution?.author?.url&&o.createElement(Le,{author:n.attribution.author.displayName,url:n.attribution.author.url}),L=(0,r.sO)(),U=(0,r.I4)((()=>W(!0)),[]),V=!D&&!O;return o.createElement(wt,{ref:L,"data-testid":`mediaElement-${h}`,"data-id":u,className:"mediaElement",width:v,height:_,margin:s,onPointerEnter:z,onFocus:z,onPointerLeave:N,onBlur:N,tabIndex:"-1"},o.createElement(bt,{$baseColor:V&&w},o.createElement(it,{type:h,src:p,mediaElement:P,resource:n,alt:y,isMuted:f,width:v,height:_,onClick:G,onLoad:U,showVideoDetail:I,active:O}),H,V&&b&&o.createElement(Ct,{hash:b,width:v,height:_,punch:1}),(!p||C(u)||x(u))&&o.createElement(Y,{loadingMessage:(0,A.__)("Uploading media…","web-stories")}),o.createElement(yt,{resource:n,display:O,onInsert:l,width:v,index:t,isLocal:"local"===c,setParentActive:z,setParentInactive:N}),"local"===c&&d&&o.createElement(Te,{resource:n,display:O,isMenuOpen:R,onMenuOpen:S,onMenuCancelled:$,onMenuSelected:j,setParentActive:z})))}var Et=(0,r.X$)((function(e){let{providerType:t="local",canEditMedia:n=!1,...r}=e;const{isCurrentResourceProcessing:i,isCurrentResourceUploading:a}=(0,ie.Z)((e=>{let{state:t}=e;return{isCurrentResourceProcessing:t.isCurrentResourceProcessing,isCurrentResourceUploading:t.isCurrentResourceUploading}})),{id:s}=r.resource;return i(s)||a(s)?o.createElement(Fe.Z,{title:(0,A.__)("Uploading media…","web-stories")},o.createElement(xt,ft({},r,{providerType:t,canEditMedia:n}))):o.createElement(xt,ft({},r,{providerType:t,canEditMedia:n}))})),vt=n(84878);const _t={maxPhotos:2},Pt=e=>{let{children:t,containerRef:n}=e;return o.createElement(vt.l0,{ref:n},t)},It=e=>{let{children:t}=e;return t};function kt(e){let{resources:t,uploadingResources:n=[],onInsert:i,providerType:a,canEditMedia:s=!1}=e;const l=[...n.map((e=>({key:`uploading-${e.id}`,src:e.src,width:e.width,height:e.height,resource:e}))),...t.map((e=>({key:e.id,src:e.src,width:e.width,height:e.height,resource:e})))].map(((e,t)=>({...e,index:t}))),c=(0,r.I4)((e=>{let{photo:t,layout:n}=e;return o.createElement(Et,{key:t.key,index:t.index,margin:"0px 0px 8px 0px",resource:t.resource,width:n.width,height:n.height,onInsert:i,providerType:a,canEditMedia:s})}),[a,i,s]);return o.createElement("div",null,o.createElement(j,{layout:"rows",photos:l,renderPhoto:c,renderRowContainer:It,renderContainer:Pt,targetRowHeight:110,rowConstraints:_t,spacing:8,defaultContainerWidth:T.ZR}))}}}]);